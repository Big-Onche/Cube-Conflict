exec "config/ui/lib.cfg"           // UI library
exec "config/ui/style.cfg"         	// Styles
exec "config/ui/scoreboard.cfg"    	// Scoreboard
exec "config/ui/edithud.cfg"       	// Edit HUD
exec "config/ui/fkey.cfg"          	// F# Key Menus
exec "config/ui/stats.cfg"         	// Player Stats
exec "config/ui/settings.cfg"       // Options Menu
exec "config/ui_FR/compte.cfg"       	// Menus de compte
exec "config/ui/classes.cfg"        // Menus d'aptitudes
exec "config/ui_FR/customisations.cfg"  // Menus des custimisations
exec "config/ui/multiplayer.cfg"    // Menus multijoueurs
exec "config/ui/solo.cfg"   		// Menus solo
exec "config/ui/credits.cfg"        // Menus de crédits

exec "config/ui/firstlaunch.cfg"    // Menu affiché après installation

togglemainmenu = [
	if (uivisible "main") [][
		if $isconnected [|| hideallui [
			toggleui pause 
			UI_menutabs 0]
		][|| hideallui [toggleui main]]
		if $paused [paused 0] [paused 1] 
	]
]

bind ECHAP [togglemainmenu]

///////////////////////////////////////////////////////////////////////////////
//  Main                                                                     //
///////////////////////////////////////////////////////////////////////////////

newui "main" [
	uitarget 1.6 0 [
		uivlist 0 [
			uiimage "media/interface/logo.png" 0.53 0.1863
			
			uispace 0.02
			
			uihlist 0 [
				uispace 0.05
				uivlist 0 [
					uicolortext "Jouer" 0xFFFFFF 0.45
					
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Single-player" 0x444444 $txtsize][uicolortext "Jeu en solo" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "solo" ; hideui "main"] -1
					]
				
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Multiplayer" 0x444444 $txtsize][uicolortext "Multijoueurs" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "multiplayer"] -1
					]

					uicolortext "Customiser" 0xFFFFFF 0.45

					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "My character" 0x444444 $txtsize][uicolortext "Mon personnage" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "skins"] -1
					]

					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Classes" 0x444444 $txtsize][uicolortext "Aptitudes" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "classes"] -1
					]

					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Skins" 0x444444 $txtsize][uicolortext "Customisation" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "skins"] -1
					]

					uicolortext "Statistiques" 0xFFFFFF 0.45
					
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Statistics" 0x444444 $txtsize][uicolortext "Statistiques" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "stats"] -1
					]
					
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Achievements" 0x444444 $txtsize][uicolortext "Succès" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "achievements"] -1
					]
				
					uicolortext "Autres" 0xFFFFFF 0.45
						
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Settings" 0x444444 $txtsize][uicolortext "Options" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "settings"] -1
					]
				
					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Credits" 0x444444 $txtsize][uicolortext "Crédits" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [showui "credits"] -1
					]

					uihgradient 0xEEEEEE 0xBBBBBB 0.03 0.05 [
						uihover [btnsize = 0.33 ; txtsize = 0.66] [btnsize = 0.3 ; txtsize = 0.6]
						UIbutton "hold5" [
							uihlist 0 [
								UItriangle 0x777777 0.02 0.02 270
								uispace 0.005
								if @GAME_LANG [uicolortext "Quit" 0x444444 $txtsize][uicolortext "Quitter" 0x444444 $txtsize]
							]
						] $btnsize 0.05 [quit] -1
					]
					uialign* -1
				]
				uialign* -1
			]
		uialign* -1
		]
	uialign* -1
	]
]

///////////////////////////////////////////////////////////////////////////////
//  Master                                                                   //
///////////////////////////////////////////////////////////////////////////////
menu_master = [if $isconnected [if $scoreboardmultiplayer [toggleui "master"]]]

UImenu "master" [
   uifill 0 0 [
      uivlist 0 [
         uihlist 0.01 [
            if (ismaster $getclientnum) [
               UIbutton "" [uitext "Relinquish Master" 0.65] 0.24 0.06 [setmaster 0]
            ] [
               if (issomeoneelsemaster) [
                  UIbutton "" [uitext "^f4Claim Master" 0.65] 0.24 0.06 []
               ] [
                  UIbutton "" [uitext "Claim Master" 0.65] 0.24 0.06 [setmaster 1]
               ]
            ]
            if (ismaster $getclientnum) [
               uigrid 2 0 0 [
                  looplist2 n i [
                     "^f0open ^f4(0)"   0 "^f0veto ^f4(1)"    1
                     "^f2locked ^f4(2)" 2 "^f3private ^f4(3)" 3
                  ] [
                     UIbutton "" [
                        UIradio [= $getmastermode $i] 0.016
                        uitext $n 0.6
                     ] 0.16 0.03 [mastermode $i] -1
                  ]
               ]
               uivlist 0 [
                  UIbutton "" [uitext "Clearbans" 0.65] 0.16 0.03 [clearbans]
                  UIbutton "" [uitext "Bots" 0.65] 0.16 0.03 [hideui "main" ; showui "bots"]
               ]
            ] [
               uifill 0.49
            ]
         ]
         uifill 0 0.02 [UIbar 1 ; uiclamp 1 1 1 1]
         if (ismaster $getclientnum) [
            if (> $getmode 2) [UI_clientlistteam] [UI_clientlistsolo]
         ] [
            if (> $getmode 2) [uifill 1.43 0.312] [uifill 0 0.624]
         ]
      ]
   ]
] [] [] [] "Master"

UI_clientlistsolo = [
   uihlist 0 [
      uiscroll 0.71 0.624 [
         uifill 0.71 0.624 [
            uitable 0 0 [
               UI_mlc = 0
               looplist cn (listclients 1 0) [
                  uitablerow [
                     uifill 0.078 0.026 [
                        uicolortext (concatword $cn " : ") (scoreboardstatus $cn) 0.57
                        uialign- 1
                     ]
                     uifill 0.362 0.026 [
                        uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.57
                        uialign- -1
                     ]
                     if (= $cn $getclientnum)[
                        uifill 0.077 0.026
                     ] [
                        UIbutton "hold2" [
                           UItriangle 0xCCCCCC 0.01 0.01 270
                           uitext "Kick" 0.57
                        ] 0.077 0.026 [kick @cn] -1
                     ]
                     UIbutton "hold2" [
                        UIradio [= (isspectator $cn) 1] 0.016
                        uitext "Spec" 0.57
                     ] 0.087 0.026 [spectator @(= (isspectator $cn) 0) @cn] -1
                     UIbutton "hold2" [
                        UIradio [= (ismaster $cn) 1] 0.016
                        uitext (concatword (? (isadmin $cn) "Admin" (? (isauth $cn) "Auth" "Master"))) 0.57
                     ] 0.105 0.026 [setmaster (? (ismaster $cn) 0 1) @cn] -1
                  ] [
                     UI_mlc = (! $UI_mlc)
                     uicolor (? $UI_mlc 0x99323232 0x99262626) 0 0 [
                        uiclamp 1 1 1 1
                        pushif highlight (scoreboardhighlight $cn) [
                           uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1
                        ]
                     ]
                  ]
               ]
            ]
            uialign* -1 -1
         ]
      ]
      uifill 0.01
      UIvscroll 0.02 0.624 1.56
   ]
]

UI_clientlistteam = [
   uihlist 0 [
      uiscroll 1.4 0.312 [
         uifill 1.4 0.312 [
            uihlist 0 [
               uialign 0 -1
               uitable 0 0 [
                  uifill 0.695
                  UI_mlc = 0
                  looplist cn (listclients 1 0) [
                     if (= (getclientteam $cn) 1) [
                        uitablerow [
                           uifill 0.078 0.026 [
                              uicolortext (concatword $cn " : ") (scoreboardstatus $cn) 0.57
                              uialign- 1
                           ]
                           uifill 0.26 0.026 [
                              uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.57
                              uialign- -1
                           ]
                           if (= $cn $getclientnum)[
                              uifill 0.077 0.026
                           ] [
                              UIbutton "hold2" [
                                 UItriangle 0xCCCCCC 0.01 0.01 270
                                 uitext "Kick" 0.57
                              ] 0.077 0.026 [kick @cn] -1
                           ]
                           UIbutton "hold2" [
                              UItriangle 0xCCCCCC 0.01 0.01 270
                              uitext "Team" 0.57
                           ] 0.0875 0.026 [setteam @cn @(? (=s (getclientteam $cn) "1") "2" "1")] -1
                           UIbutton "hold2" [
                              UIradio [= (isspectator $cn) 1] 0.016
                              uitext "Spec" 0.57
                           ] 0.087 0.026 [spectator @(= (isspectator $cn) 0) @cn] -1
                           UIbutton "hold2" [
                              UIradio [= (ismaster $cn) 1] 0.016
                              uitext (concatword (? (isadmin $cn) "Admin" (? (isauth $cn) "Auth" "Master"))) 0.57
                           ] 0.105 0.026 [setmaster (? (ismaster $cn) 0 1) @cn] -1
                        ] [
                           UI_mlc = (! $UI_mlc)
                           uicolor (? $UI_mlc 0x99333b40 0x99262b33) 0 0 [
                              uiclamp 1 1 1 1
                              pushif highlight (scoreboardhighlight $cn) [
                                 uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               uifill 0.01
               uitable 0 0 [
                  uifill 0.695
                  UI_mlc = 0
                  looplist cn (listclients 1 0) [
                     if (= (getclientteam $cn) 2) [
                        uitablerow [
                           uifill 0.078 0.026 [
                              uicolortext (concatword $cn " : ") (scoreboardstatus $cn) 0.57
                              uialign- 1
                           ]
                           uifill 0.26 0.026 [
                              uicolortext (getclientcolorname $cn) (scoreboardstatus $cn) 0.57
                              uialign- -1
                           ]
                           if (= $cn $getclientnum)[
                              uifill 0.077 0.026
                           ] [
                              UIbutton "hold2" [
                                 UItriangle 0 0.01 0.01 270
                                 uitext "Kick" 0.57
                              ] 0.077 0.026 [kick @cn] -1
                           ]
                           UIbutton "hold2" [
                              UItriangle 0 0.01 0.01 270
                              uitext "Team" 0.57
                           ] 0.0875 0.026 [setteam @cn @(? (=s (getclientteam $cn) "1") "2" "1")] -1
                           UIbutton "hold2" [
                              UIradio [= (isspectator $cn) 1] 0.016
                              uitext "Spec" 0.57
                           ] 0.087 0.026 [spectator @(= (isspectator $cn) 0) @cn] -1
                           UIbutton "hold2" [
                              UIradio [= (ismaster $cn) 1] 0.016
                              uitext (concatword (? (isadmin $cn) "Admin" (? (isauth $cn) "Auth" "Master"))) 0.57
                           ] 0.105 0.026 [setmaster (? (ismaster $cn) 0 1) @cn] -1
                        ] [
                           UI_mlc = (! $UI_mlc)
                           uicolor (? $UI_mlc 0x99403333 0x99332626) 0 0 [
                              uiclamp 1 1 1 1
                              pushif highlight (scoreboardhighlight $cn) [
                                 uioutline 0xA0A0A0 ; uiclamp- 1 1 1 1
                              ]
                           ]
                        ]
                     ]
                  ]
               ]
               uialign* 0 -1
            ]
         ]
      ]
      uifill 0.01
      UIvscroll 0.02 0.312 1.56
   ]
]

///////////////////////////////////////////////////////////////////////////////
//  Bots                                                                     //
///////////////////////////////////////////////////////////////////////////////
UI_botskill = 87
UI_botaddnum = 9

UImenu "bots" [
   uifill 0.65 0.27 [
      uivlist 0.01 [
         uitext (concatword "Bots: " (numbots)) 0.6
         uifill 0 0.01
         uihlist 0.01 [
            uialign 1 ; uitext "Skill Level" 0.6 ; UIhslider UI_botskill 1 100 1 0.5 0.032 [uitext $UI_botskill 0.6]
         ]
         uihlist 0.01 [
            uialign 1 ; uitext "#" 0.6 ; UIhslider UI_botaddnum 2 32 1 0.5 0.032 [uitext $UI_botaddnum 0.6]
         ]
         uifill 0 0.015
         uihlist 0.05 [
            uivlist 0.01 [
               UIbutton "" [uitext "Add Bot" 0.65 ; UI_keyref 1 0.027 0.027 "Ins" "" 0.4] 0.2 0.04 [addbot $UI_botskill]
               UIbutton "" [uitext (concatword "Add " $UI_botaddnum " Bots") 0.65] 0.2 0.04 [loop a (UI_botaddnum) [addbot $UI_botskill]]
            ]
            uivlist 0.01 [
               UIbutton "" [uitext "Delete Bot" 0.65 ; UI_keyref 1 0.027 0.027 "Del" "" 0.4] 0.2 0.04 [delbot]
               UIbutton "" [uitext "Clear Bots" 0.65] 0.2 0.04 [clearbots]
            ]
         ]
      ]
   ]
] [] [] [] "Bots"

///////////////////////////////////////////////////////////////////////////////
//  Notepad                                                                  //
///////////////////////////////////////////////////////////////////////////////
UI_notepadfile = "untitled.txt"
UI_cmc_from   = ""
UI_cmc_to     = ""

UImenu "notepad" [
   uivlist 0.01 [
      uihlist 0.01 [
         uialign -1 -2
         uifield UI_notepadfile -35 [] 0.6 [
            uioutline (uifocus? 0xFF0000 $c_line)
            uiclamp- 1 1 1 1
         ]
         UIbutton "hold2" [uitext "Load"       0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textload $UI_notepadfile]
         UIbutton "hold2" [uitext "Save"       0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textsave $UI_notepadfile]
         UIbutton "hold2" [uitext "Exec"       0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textexec]
         uispace 0.01 0 [UIbar 0 1]
         UIbutton "hold2" [uitext "Copy"       0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textcopy]
         UIbutton "hold2" [uitext "Paste"      0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textpaste]
         UIbutton "hold2" [uitext "Select All" 0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textselectall]
         uispace 0.01 0 [UIbar 0 1]
         UIbutton "hold2" [uitext "Clear All"  0.6] 0.04 0.032 [textfocus $UI_notepadfile ; textclear]
      ]
      uitexteditor $UI_notepadfile -80 20 1 "" 0 [
         uioutline (uifocus? 0xFF0000 $c_line)
         uiclamp- 1 1 1 1
      ]
      textinit $UI_notepadfile $UI_notepadfile
   ]
] [] [] [] "Notepad"

notepad = [
   if $numargs [UI_notepadfile = $arg1]
   showui "notepad"
]

mapnotepad = [
   UI_notepadfile = (concatword "media/map/" (? $numargs $arg1 $mapname) ".cfg")
   showui "notepad"
]

copymapcfg = [
   if $numargs [
      UI_cmc_from = $arg1
      UI_cmc_to   = (? (= $numargs 2) $arg2 $mapname)
      if (findfile (concatword "media/map/" $UI_cmc_from ".cfg")) [
         if (findfile (concatword "media/map/" $UI_cmc_to ".cfg")) [showui "cmc_confirm"] [
            textfocus "#copymapcfg"
            textload (concatword "media/map/" $UI_cmc_from ".cfg")
            textsave (concatword "media/map/" $UI_cmc_to   ".cfg")
         ]
      ] [
         echo (concatword "^f7Map config "^f8^" $UI_cmc_from "^f7^" does not exist!")
         UI_cmc_from = "" ; UI_cmc_to = ""
      ]
   ]
]

UImenu "cmc_confirm" [
   uivlist 0.02 [
      uiclamp 1 1
      UItitle [uitext "Copy map config:" 0.6] 0 0.03
      uiclamp- 1 1
      uivlist 0.01 [
         uitext (concatword "^f2" $UI_cmc_from) 0.6
         UItriangle 0 0.01 0.01 180
         uitext (concatword "^f2" $UI_cmc_to) 0.6
      ]
      uihlist 0 [
         UIbutton "hold2" [uitext "Proceed" 0.6] 0.18 0.032 [
            textfocus "#copymapcfg"
            textload (concatword "media/map/" $UI_cmc_from ".cfg")
            textsave (concatword "media/map/" $UI_cmc_to   ".cfg")
            hideui "cmc_confirm"
         ]
         UIbutton "hold2" [uitext "Cancel"  0.6] 0.18 0.032 [hideui "cmc_confirm"]
      ]
   ]
] [
   if (|| [=s $UI_cmc_from ""] [=s $UI_cmc_to ""]) [hideui "cmc_confirm"]
] [UI_cmc_from = "" ; UI_cmc_to = ""]

